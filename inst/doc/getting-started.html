<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="EmpiricalDynamics Package" />

<meta name="date" content="2026-01-11" />

<title>Getting Started with EmpiricalDynamics</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Getting Started with EmpiricalDynamics</h1>
<h4 class="author">EmpiricalDynamics Package</h4>
<h4 class="date">2026-01-11</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>EmpiricalDynamics</code> package provides a complete
workflow for discovering differential equations from time series data.
This approach, sometimes called “equation discovery” or “symbolic
regression for dynamics,” allows researchers to uncover the mathematical
laws governing observed phenomena.</p>
<p>The package implements a six-step workflow:</p>
<ol style="list-style-type: decimal">
<li><strong>Preprocessing</strong>: Compute numerical derivatives from
noisy time series</li>
<li><strong>Exploration</strong>: Visual analysis to identify functional
relationships</li>
<li><strong>Symbolic Search</strong>: Discover equation structure
automatically</li>
<li><strong>Residual Analysis</strong>: Construct stochastic
differential equations (SDEs)</li>
<li><strong>Validation</strong>: Cross-validation, trajectory
simulation, qualitative checks</li>
<li><strong>Output</strong>: Generate publication-ready reports and
LaTeX equations</li>
</ol>
</div>
<div id="installation" class="section level1">
<h1>Installation</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Install from local source</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;EmpiricalDynamics&quot;</span>, <span class="at">repos =</span> <span class="cn">NULL</span>, <span class="at">type =</span> <span class="st">&quot;source&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># Or using devtools</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;your-repo/EmpiricalDynamics&quot;</span>)</span></code></pre></div>
</div>
<div id="quick-start-example" class="section level1">
<h1>Quick Start Example</h1>
<p>Let’s discover the equation governing logistic population growth.</p>
<div id="step-1-load-data-and-compute-derivatives" class="section level2">
<h2>Step 1: Load Data and Compute Derivatives</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(EmpiricalDynamics)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># Load example data</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>logistic_growth <span class="ot">&lt;-</span> <span class="fu">load_example_data</span>(<span class="st">&quot;logistic_growth&quot;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co"># View the data</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">head</span>(logistic_growth)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co"># Compute derivative using Total Variation Regularization (recommended)</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>deriv <span class="ot">&lt;-</span> <span class="fu">compute_derivative</span>(</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  logistic_growth<span class="sc">$</span>Z,</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  <span class="at">time =</span> logistic_growth<span class="sc">$</span>time,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;tvr&quot;</span>,</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="st">&quot;auto&quot;</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co"># Add derivative to data</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>logistic_growth<span class="sc">$</span>dZ <span class="ot">&lt;-</span> deriv<span class="sc">$</span>derivative</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co"># Plot diagnostic</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="fu">plot</span>(deriv)</span></code></pre></div>
</div>
<div id="step-2-explore-the-data" class="section level2">
<h2>Step 2: Explore the Data</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Explore relationships between dZ/dt and Z</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>exploration <span class="ot">&lt;-</span> <span class="fu">explore_dynamics</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">data =</span> logistic_growth,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">response =</span> <span class="st">&quot;dZ&quot;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">predictors =</span> <span class="st">&quot;Z&quot;</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># View suggestions for functional forms</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">print</span>(exploration<span class="sc">$</span>suggestions)</span></code></pre></div>
</div>
<div id="step-3-fit-the-equation" class="section level2">
<h2>Step 3: Fit the Equation</h2>
<p>Based on theory, logistic growth follows: <span class="math inline">\(\frac{dZ}{dt} = rZ(1 - Z/K)\)</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Fit the theoretical equation</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>equation <span class="ot">&lt;-</span> <span class="fu">fit_specified_equation</span>(</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="st">&quot;r * Z * (1 - Z / K)&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">data =</span> logistic_growth,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">derivative_col =</span> <span class="st">&quot;dZ&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">start =</span> <span class="fu">list</span>(<span class="at">r =</span> <span class="fl">0.5</span>, <span class="at">K =</span> <span class="dv">100</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co"># View results</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="fu">summary</span>(equation)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(equation))</span></code></pre></div>
</div>
<div id="step-4-validate-the-model" class="section level2">
<h2>Step 4: Validate the Model</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Run comprehensive validation</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>validation <span class="ot">&lt;-</span> <span class="fu">validate_model</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">equation =</span> equation,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">data =</span> logistic_growth,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">derivative_col =</span> <span class="st">&quot;dZ&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">&quot;Z&quot;</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">cv_folds =</span> <span class="dv">5</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="fu">print</span>(validation)</span></code></pre></div>
</div>
<div id="step-5-generate-output" class="section level2">
<h2>Step 5: Generate Output</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Get LaTeX equation</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>latex_eq <span class="ot">&lt;-</span> <span class="fu">to_latex</span>(equation, <span class="at">variable =</span> <span class="st">&quot;Z&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">cat</span>(latex_eq)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co"># Generate full report (using tempdir() per CRAN policy)</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="fu">generate_report</span>(</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="at">results =</span> <span class="fu">list</span>(</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    <span class="at">data =</span> logistic_growth,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>    <span class="at">equation =</span> equation,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    <span class="at">validation =</span> validation</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  ),</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="at">output_file =</span> <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;logistic_analysis&quot;</span>),</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">&quot;markdown&quot;</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="detailed-workflow" class="section level1">
<h1>Detailed Workflow</h1>
<div id="a.-numerical-differentiation" class="section level2">
<h2>A. Numerical Differentiation</h2>
<p>Computing reliable derivatives from noisy data is critical. The
package offers several methods:</p>
<div id="total-variation-regularization-tvr" class="section level3">
<h3>Total Variation Regularization (TVR)</h3>
<p><strong>Recommended for most applications</strong>, especially
economic data with trends and structural breaks.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>deriv_tvr <span class="ot">&lt;-</span> <span class="fu">compute_derivative</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="at">y =</span> data<span class="sc">$</span>Z,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">time =</span> data<span class="sc">$</span>time,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;tvr&quot;</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="st">&quot;auto&quot;</span>  <span class="co"># Automatic regularization selection</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># Plot diagnostic: shows original, derivative, reconstruction, residuals</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="fu">plot_tvr_diagnostic</span>(deriv_tvr)</span></code></pre></div>
<p>TVR solves the optimization problem: <span class="math display">\[\min_{\dot{Z}} \left\| Z - \int \dot{Z} \, dt
\right\|_2^2 + \lambda \|\Delta \dot{Z}\|_1\]</span></p>
</div>
<div id="other-methods" class="section level3">
<h3>Other Methods</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Savitzky-Golay filter (preserves peaks, good for smooth data)</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>deriv_sg <span class="ot">&lt;-</span> <span class="fu">compute_derivative</span>(y, time, <span class="at">method =</span> <span class="st">&quot;savgol&quot;</span>, </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                                <span class="at">window =</span> <span class="dv">11</span>, <span class="at">order =</span> <span class="dv">3</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co"># Smoothing spline (good for high noise)</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>deriv_spline <span class="ot">&lt;-</span> <span class="fu">compute_derivative</span>(y, time, <span class="at">method =</span> <span class="st">&quot;spline&quot;</span>, </span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>                                    <span class="at">spar =</span> <span class="fl">0.7</span>)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co"># Finite differences (simple, fast, sensitive to noise)</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>deriv_fd <span class="ot">&lt;-</span> <span class="fu">compute_derivative</span>(y, time, <span class="at">method =</span> <span class="st">&quot;fd&quot;</span>)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co"># Spectral (for periodic data ONLY - warns about Gibbs phenomenon otherwise)</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>deriv_spec <span class="ot">&lt;-</span> <span class="fu">compute_derivative</span>(y, time, <span class="at">method =</span> <span class="st">&quot;spectral&quot;</span>)</span></code></pre></div>
</div>
<div id="automatic-method-selection" class="section level3">
<h3>Automatic Method Selection</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Get recommendation based on data characteristics</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>suggestion <span class="ot">&lt;-</span> <span class="fu">suggest_differentiation_method</span>(data<span class="sc">$</span>Z, data<span class="sc">$</span>time)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">print</span>(suggestion)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co"># Compare all methods visually</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">compare_differentiation_methods</span>(data<span class="sc">$</span>Z, data<span class="sc">$</span>time)</span></code></pre></div>
</div>
</div>
<div id="b.-visual-exploration" class="section level2">
<h2>B. Visual Exploration</h2>
<p>Before formal fitting, explore the data visually:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Comprehensive exploration</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>exploration <span class="ot">&lt;-</span> <span class="fu">explore_dynamics</span>(</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">response =</span> <span class="st">&quot;dZ&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="at">predictors =</span> <span class="fu">c</span>(<span class="st">&quot;Z&quot;</span>, <span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co"># Individual plots</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="fu">plot_phase_1d</span>(data, <span class="at">x =</span> <span class="st">&quot;Z&quot;</span>, <span class="at">y =</span> <span class="st">&quot;dZ&quot;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="fu">plot_bivariate</span>(data, <span class="at">x =</span> <span class="st">&quot;Z&quot;</span>, <span class="at">y =</span> <span class="st">&quot;dZ&quot;</span>)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="fu">plot_surface_3d</span>(data, <span class="at">x1 =</span> <span class="st">&quot;Z&quot;</span>, <span class="at">x2 =</span> <span class="st">&quot;X&quot;</span>, <span class="at">y =</span> <span class="st">&quot;dZ&quot;</span>)</span></code></pre></div>
</div>
<div id="c.-equation-discovery" class="section level2">
<h2>C. Equation Discovery</h2>
<div id="automated-symbolic-search" class="section level3">
<h3>Automated Symbolic Search</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Genetic algorithm search (pure R)</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>search_result <span class="ot">&lt;-</span> <span class="fu">symbolic_search</span>(</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="at">response =</span> <span class="st">&quot;dZ&quot;</span>,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="at">predictors =</span> <span class="fu">c</span>(<span class="st">&quot;Z&quot;</span>, <span class="st">&quot;X&quot;</span>),</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;r_genetic&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="at">max_complexity =</span> <span class="dv">15</span>,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="at">n_generations =</span> <span class="dv">50</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  <span class="at">population_size =</span> <span class="dv">100</span>,</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  <span class="at">n_runs =</span> <span class="dv">3</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co"># View Pareto front</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="fu">plot_pareto_front</span>(search_result)</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co"># Select best equation</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>best_eq <span class="ot">&lt;-</span> <span class="fu">select_equation</span>(search_result, <span class="at">criterion =</span> <span class="st">&quot;bic&quot;</span>)</span></code></pre></div>
</div>
<div id="theory-guided-fitting" class="section level3">
<h3>Theory-Guided Fitting</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Fit a specific functional form</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>equation <span class="ot">&lt;-</span> <span class="fu">fit_specified_equation</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="st">&quot;alpha + beta * Z + gamma * Z^2 + delta * X&quot;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="at">derivative_col =</span> <span class="st">&quot;dZ&quot;</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;levenberg-marquardt&quot;</span>  <span class="co"># Robust optimization</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="fu">summary</span>(equation)</span></code></pre></div>
</div>
<div id="julia-backend-optional" class="section level3">
<h3>Julia Backend (Optional)</h3>
<p>For large-scale symbolic regression, use the Julia backend:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Setup Julia (one-time)</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">setup_julia_backend</span>()</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># Run with Julia&#39;s SymbolicRegression.jl</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>search_result <span class="ot">&lt;-</span> <span class="fu">symbolic_search</span>(</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="at">response =</span> <span class="st">&quot;dZ&quot;</span>,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  <span class="at">predictors =</span> <span class="fu">c</span>(<span class="st">&quot;Z&quot;</span>, <span class="st">&quot;X&quot;</span>),</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;julia&quot;</span>,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  <span class="at">max_complexity =</span> <span class="dv">25</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="d.-residual-analysis-and-sde-construction" class="section level2">
<h2>D. Residual Analysis and SDE Construction</h2>
<div id="diagnostics" class="section level3">
<h3>Diagnostics</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Compute residuals</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>resid <span class="ot">&lt;-</span> <span class="fu">compute_residuals</span>(equation, data, <span class="st">&quot;dZ&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># Run diagnostic tests</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>diag <span class="ot">&lt;-</span> <span class="fu">residual_diagnostics</span>(resid, data)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="fu">print</span>(diag)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">plot</span>(diag)</span></code></pre></div>
<p>The diagnostics include: - <strong>Ljung-Box test</strong>:
Autocorrelation in residuals - <strong>ARCH-LM test</strong>:
Conditional heteroscedasticity - <strong>Breusch-Pagan test</strong>:
Heteroscedasticity vs predictors - <strong>Jarque-Bera test</strong>:
Normality - <strong>Runs test</strong>: Randomness</p>
</div>
<div id="modeling-the-diffusion" class="section level3">
<h3>Modeling the Diffusion</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Model conditional variance</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>var_model <span class="ot">&lt;-</span> <span class="fu">model_conditional_variance</span>(</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  resid,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">predictors =</span> <span class="fu">c</span>(<span class="st">&quot;Z&quot;</span>),</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;linear&quot;</span>  <span class="co"># or &quot;quadratic&quot;, &quot;symbolic&quot;</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co"># Construct SDE: dZ = f(Z,X) dt + g(Z) dW</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>sde <span class="ot">&lt;-</span> <span class="fu">construct_sde</span>(</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>  <span class="at">drift =</span> equation,</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  <span class="at">diffusion =</span> var_model,</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">&quot;Z&quot;</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>)</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="fu">print</span>(sde)</span></code></pre></div>
</div>
<div id="iterative-gls-estimation" class="section level3">
<h3>Iterative GLS Estimation</h3>
<p>When heteroscedasticity is significant, use iterative GLS:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Iterative estimation for unbiased drift coefficients</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>sde <span class="ot">&lt;-</span> <span class="fu">estimate_sde_iterative</span>(</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="at">drift_formula =</span> <span class="st">&quot;a + b * Z + c * Z^2&quot;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="at">derivative_col =</span> <span class="st">&quot;dZ&quot;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  <span class="at">diffusion_formula =</span> <span class="st">&quot;sigma * (1 + tau * abs(Z))&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="at">max_iter =</span> <span class="dv">20</span>,</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="fl">1e-4</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co"># Check convergence</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="fu">print</span>(sde<span class="sc">$</span>converged)</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="fu">print</span>(sde<span class="sc">$</span>iterations)</span></code></pre></div>
</div>
</div>
<div id="e.-validation" class="section level2">
<h2>E. Validation</h2>
<div id="cross-validation" class="section level3">
<h3>Cross-Validation</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Block cross-validation (recommended for time series)</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">cross_validate</span>(</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  equation,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="at">derivative_col =</span> <span class="st">&quot;dZ&quot;</span>,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">5</span>,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;block&quot;</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="fu">print</span>(cv)</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="fu">plot</span>(cv)</span></code></pre></div>
</div>
<div id="trajectory-simulation" class="section level3">
<h3>Trajectory Simulation</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Simulate from the SDE</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">simulate_trajectory</span>(</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  sde,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="at">initial_conditions =</span> <span class="fu">c</span>(<span class="at">Z =</span> data<span class="sc">$</span>Z[<span class="dv">1</span>]),</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="at">times =</span> data<span class="sc">$</span>time,</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="at">n_sims =</span> <span class="dv">100</span>,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;euler&quot;</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>)</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co"># Plot with observed data</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="fu">plot</span>(sim, <span class="at">observed_data =</span> data)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co"># Compare quantitatively</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>metrics <span class="ot">&lt;-</span> <span class="fu">compare_trajectories</span>(sim, data, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;Z&quot;</span>)</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="fu">print</span>(metrics)</span></code></pre></div>
</div>
<div id="qualitative-behavior" class="section level3">
<h3>Qualitative Behavior</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Analyze fixed points</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>fps <span class="ot">&lt;-</span> <span class="fu">analyze_fixed_points</span>(equation, <span class="st">&quot;Z&quot;</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">150</span>))</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">print</span>(fps)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co"># Bifurcation analysis (vary a parameter)</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>bifurc <span class="ot">&lt;-</span> <span class="fu">analyze_bifurcations</span>(</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  equation, </span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">&quot;Z&quot;</span>,</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  <span class="at">parameter =</span> <span class="st">&quot;K&quot;</span>,</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  <span class="at">param_range =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">200</span>)</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="fu">plot</span>(bifurc)</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co"># Check against expected behavior</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>qual_check <span class="ot">&lt;-</span> <span class="fu">check_qualitative_behavior</span>(</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>  equation, data, <span class="st">&quot;Z&quot;</span>,</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>  <span class="at">expected_features =</span> <span class="fu">list</span>(</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>    <span class="at">n_fixed_points =</span> <span class="dv">2</span>,</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a>    <span class="at">stability_pattern =</span> <span class="fu">c</span>(<span class="st">&quot;unstable&quot;</span>, <span class="st">&quot;stable&quot;</span>),</span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>    <span class="at">bounded =</span> <span class="cn">TRUE</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>  )</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>)</span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a><span class="fu">print</span>(qual_check)</span></code></pre></div>
</div>
<div id="comprehensive-validation" class="section level3">
<h3>Comprehensive Validation</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>validation <span class="ot">&lt;-</span> <span class="fu">validate_model</span>(</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="at">equation =</span> equation,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="at">sde =</span> sde,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="at">derivative_col =</span> <span class="st">&quot;dZ&quot;</span>,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">&quot;Z&quot;</span>,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  <span class="at">time_col =</span> <span class="st">&quot;time&quot;</span>,</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  <span class="at">cv_folds =</span> <span class="dv">5</span>,</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="at">n_sims =</span> <span class="dv">100</span>,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  <span class="at">expected_features =</span> <span class="fu">list</span>(<span class="at">n_fixed_points =</span> <span class="dv">2</span>)</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>)</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="fu">print</span>(validation)</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="fu">plot</span>(validation)</span></code></pre></div>
</div>
</div>
<div id="f.-output-and-reporting" class="section level2">
<h2>F. Output and Reporting</h2>
<div id="latex-equations" class="section level3">
<h3>LaTeX Equations</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Convert to LaTeX</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>latex <span class="ot">&lt;-</span> <span class="fu">to_latex</span>(equation, <span class="at">variable =</span> <span class="st">&quot;Z&quot;</span>, <span class="at">precision =</span> <span class="dv">4</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">cat</span>(latex)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co"># Full SDE in LaTeX</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>sde_latex <span class="ot">&lt;-</span> <span class="fu">to_latex</span>(sde, <span class="at">variable =</span> <span class="st">&quot;Z&quot;</span>)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="fu">cat</span>(sde_latex)</span></code></pre></div>
</div>
<div id="tables" class="section level3">
<h3>Tables</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Coefficient table</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>coef_table <span class="ot">&lt;-</span> <span class="fu">coefficient_table</span>(equation, <span class="at">format =</span> <span class="st">&quot;latex&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">cat</span>(coef_table)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co"># Model comparison</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="st">&quot;Linear&quot;</span> <span class="ot">=</span> <span class="fu">fit_specified_equation</span>(<span class="st">&quot;a + b*Z&quot;</span>, data, <span class="st">&quot;dZ&quot;</span>),</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>  <span class="st">&quot;Quadratic&quot;</span> <span class="ot">=</span> <span class="fu">fit_specified_equation</span>(<span class="st">&quot;a + b*Z + c*Z^2&quot;</span>, data, <span class="st">&quot;dZ&quot;</span>),</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>  <span class="st">&quot;Logistic&quot;</span> <span class="ot">=</span> <span class="fu">fit_specified_equation</span>(<span class="st">&quot;r*Z*(1-Z/K)&quot;</span>, data, <span class="st">&quot;dZ&quot;</span>)</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>)</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">model_comparison_table</span>(models, data, <span class="st">&quot;dZ&quot;</span>, <span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>)</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="fu">cat</span>(comparison)</span></code></pre></div>
</div>
<div id="full-report" class="section level3">
<h3>Full Report</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Collect all results</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="at">exploration =</span> exploration,</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="at">equation =</span> equation,</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  <span class="at">sde =</span> sde,</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="at">validation =</span> validation</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>)</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co"># Generate markdown report (using tempdir() per CRAN policy)</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="fu">generate_report</span>(</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>  results,</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>  <span class="at">output_file =</span> <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;analysis_report&quot;</span>),</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>,</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;My Dynamics Analysis&quot;</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>)</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co"># Export to multiple formats (using tempdir() per CRAN policy)</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="fu">export_results</span>(results, <span class="at">output_dir =</span> <span class="fu">tempdir</span>(), <span class="at">formats =</span> <span class="fu">c</span>(<span class="st">&quot;rds&quot;</span>, <span class="st">&quot;csv&quot;</span>, <span class="st">&quot;json&quot;</span>))</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co"># Save plots (using tempdir() per CRAN policy)</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="fu">save_plots</span>(results, <span class="at">output_dir =</span> <span class="fu">tempdir</span>(), <span class="at">format =</span> <span class="fu">c</span>(<span class="st">&quot;png&quot;</span>, <span class="st">&quot;pdf&quot;</span>))</span></code></pre></div>
</div>
<div id="analysis-summary" class="section level3">
<h3>Analysis Summary</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Print summary to console</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">print_summary</span>(results)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co"># Get template for new analyses (using tempdir() per CRAN policy)</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="fu">get_analysis_template</span>(<span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;my_analysis.R&quot;</span>))</span></code></pre></div>
</div>
</div>
</div>
<div id="best-practices" class="section level1">
<h1>Best Practices</h1>
<div id="differentiation" class="section level2">
<h2>Differentiation</h2>
<ol style="list-style-type: decimal">
<li><strong>Start with TVR</strong> for economic/social science
data</li>
<li>Use <code>suggest_differentiation_method()</code> for guidance</li>
<li>Always plot diagnostics to verify derivative quality</li>
<li>Consider data collection frequency via
<code>diagnose_sampling_frequency()</code></li>
</ol>
</div>
<div id="equation-discovery" class="section level2">
<h2>Equation Discovery</h2>
<ol style="list-style-type: decimal">
<li><strong>Use theory when available</strong> -
<code>fit_specified_equation()</code> is more reliable</li>
<li>For exploratory analysis, use symbolic search but validate
thoroughly</li>
<li>Prefer simpler equations (parsimony)</li>
<li>Run multiple searches and compare</li>
</ol>
</div>
<div id="validation" class="section level2">
<h2>Validation</h2>
<ol style="list-style-type: decimal">
<li><strong>Always use block CV</strong> for time series (not random
CV)</li>
<li>Check residual diagnostics before trusting results</li>
<li>Verify qualitative behavior matches domain knowledge</li>
<li>Use bootstrap for uncertainty quantification</li>
</ol>
</div>
<div id="reporting" class="section level2">
<h2>Reporting</h2>
<ol style="list-style-type: decimal">
<li>Report uncertainty (standard errors or confidence intervals)</li>
<li>Include model comparison with alternatives</li>
<li>Show validation metrics prominently</li>
<li>Discuss limitations and assumptions</li>
</ol>
</div>
</div>
<div id="further-reading" class="section level1">
<h1>Further Reading</h1>
<ul>
<li>Brunton, S. L., &amp; Kutz, J. N. (2019). <em>Data-Driven Science
and Engineering</em></li>
<li>Schmidt, M., &amp; Lipson, H. (2009). Distilling free-form natural
laws from experimental data. <em>Science</em>, 324(5923), 81-85.</li>
<li>Chartrand, R. (2011). Numerical differentiation of noisy, nonsmooth
data. <em>ISRN Applied Mathematics</em>, 2011.</li>
</ul>
</div>
<div id="session-info" class="section level1">
<h1>Session Info</h1>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="co">#&gt; R version 4.4.2 (2024-10-31 ucrt)</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co">#&gt; Running under: Windows 11 x64 (build 26200)</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co">#&gt; Matrix products: default</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#&gt; locale:</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt; [1] LC_COLLATE=C                   LC_CTYPE=Spanish_Spain.utf8   </span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#&gt; [3] LC_MONETARY=Spanish_Spain.utf8 LC_NUMERIC=C                  </span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#&gt; [5] LC_TIME=Spanish_Spain.utf8    </span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co">#&gt; time zone: America/Costa_Rica</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a><span class="co">#&gt; tzcode source: internal</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="co">#&gt; attached base packages:</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a><span class="co">#&gt;  [1] digest_0.6.37     R6_2.6.1          fastmap_1.2.0     xfun_0.55        </span></span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a><span class="co">#&gt;  [5] cachem_1.1.0      knitr_1.51        htmltools_0.5.8.1 rmarkdown_2.29   </span></span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a><span class="co">#&gt;  [9] lifecycle_1.0.4   cli_3.6.5         sass_0.4.10       jquerylib_0.1.4  </span></span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a><span class="co">#&gt; [13] compiler_4.4.2    rstudioapi_0.17.1 tools_4.4.2       evaluate_1.0.5   </span></span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a><span class="co">#&gt; [17] bslib_0.9.0       yaml_2.3.12       rlang_1.1.6       jsonlite_2.0.0</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
